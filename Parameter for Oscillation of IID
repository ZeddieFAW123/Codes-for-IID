%% 1. Define model parameters
% Increase the intrinsic growth rate of seaweed (r)
% and the predation rate (alpha) to encourage oscillations
param.r      = 0.20;   % Intrinsic growth rate of seaweed (day^-1)
param.alpha  = 0.01;   % Predation rate coefficient (increased)
param.beta   = 0.8;    % Conversion efficiency of S to P
param.mu     = 0.05;   % Natural death rate (pathogen)

% Environmental conditions (assumed constant here)
param.sigma  = 30;     % Current salinity
param.delta  = 29;     % Current temperature

% Optimal conditions for seaweed
param.sigma0S = 30;  
param.delta0S = 28;  

% Optimal conditions for pathogen
param.sigma0P = 31;
param.delta0P = 30;

% Exponential coefficients
% (Keep them modest so we don't suppress or boost growth too strongly.)
param.a1 = 0.05; 
param.b1 = 0.05;
param.a2 = 0.05;
param.b2 = 0.05;

% -- Here's the trick: set f(σ,δ) close to 0 so the predator
%    relies mostly on feeding to grow (classic predator-prey).
%    This often helps generate stable or sustained oscillations.
param.a3 = 0;   
param.b3 = 0;
param.fmin = 0.0;
param.fmax = 0.0;

% Carrying capacity parameters
% Give the seaweed enough capacity to grow large and "fuel" the predator.
param.Kmin  = 100;
param.Kmax  = 900;  % This means K(σ,δ) could be ~100 to 1000 total

%% 2. Initial Conditions
S0 = 40;  % Seaweed
P0 = 5;   % Pathogen
X0 = [S0; P0];

%% 3. Time Span
tSpan = [0 200];  % days

%% Solve the ODE System
[tSol, XSol] = ode45(@(t,X) seaweedPredatorModel(t, X, param), tSpan, X0);

% Extract solutions
S_sol = XSol(:,1);
P_sol = XSol(:,2);

%% 5a. Plot the Time‐Series
figure;
plot(tSol, S_sol, 'LineWidth', 2); hold on;
plot(tSol, P_sol, 'LineWidth', 2);
xlabel('Time (\itt)');
ylabel('Population Size');
legend({'Seaweed (\itS)', 'Pathogen (\itP)'}, 'Location', 'best');
title('Seaweed–Pathogen Model Simulation (Time Series)');
grid on;

%% 5b. Plot the Phase‐Plane (Optional)
figure;
plot(S_sol, P_sol, 'LineWidth', 2);
xlabel('Seaweed (S)');
ylabel('Pathogen (P)');
title('Phase Plane: Seaweed vs. Pathogen');
grid on;
